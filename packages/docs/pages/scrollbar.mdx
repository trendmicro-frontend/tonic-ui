# Scrollbar

## Import

```js
import {
  Scrollbar
} from '@trendmicro/react-styled-ui';
```

## Usage

The scrollbar default is hidden until you hover the mouse pointer over the content.

```jsx
<Scrollbar
  height={200}
  border={1}
  borderColor="#424242"
  overflow="auto"
  resize="both"
>
  <Lorem count={10} px="4x" py="3x" />
</Scrollbar>
```

### Overflow

Use the `overflow` prop to set the overflow of the content. You can set the value to `auto`, `scroll`, or `hidden`.

* `auto`: The scrollbar will be shown if the content overflows and mouse is hovering over the content.
* `scroll`: The scrollbar is always visible if the content overflows.
* `hidden`: The scrollbar is never shown.

Note: `overflowX` and `overflowY` are also available if you need to set the overflow on both X and Y axis.

```jsx
<Flex>
  <Box flex="auto" mr="4x">
    <Text size="xl" marginBottom="2x">
      overflow="auto"
    </Text>
    <Scrollbar
      height={150}
      border={1}
      borderColor="#424242"
      overflow="auto"
    >
      <Lorem count={10} px="4x" py="3x" whiteSpace="nowrap" />
    </Scrollbar>
  </Box>
  <Box flex="auto" mr="4x">
    <Text size="xl" marginBottom="2x">
      overflow="scroll"
    </Text>
    <Scrollbar
      height={150}
      border={1}
      borderColor="#424242"
      overflow="scroll"
    >
      <Lorem count={10} px="4x" py="3x" whiteSpace="nowrap" />
    </Scrollbar>
  </Box>
  <Box flex="auto" mr="4x">
    <Text size="xl" marginBottom="2x">
      overflow="hidden"
    </Text>
    <Scrollbar
      height={150}
      border={1}
      borderColor="#424242"
      overflow="hidden"
    >
      <Lorem count={10} px="4x" py="3x" whiteSpace="nowrap" />
    </Scrollbar>
  </Box>
</Flex>
```

### Disabled

Use the `disabled` attribute, the overflow is clipped, and the rest of the content is hidden.

```jsx
<Scrollbar height={160} disabled>
  <Lorem count={10} px="4x" py="3x" />
</Scrollbar>
```

### The minimal thumb size

Use the `minThumbSize` attribute to set the minimal size (in pixels) for thumbs.

The thumbs size will be the original size if the original size > the minimal size. In other words, the thumbs size will be the minimal size if the original size < the minimal size.

```jsx
function MinThumbSizeScroll() {
  const [minThumbSize, setMinThumbSize] = React.useState(32);
  const [dataRow, setDataRow] = React.useState(8);

  return (
    <>
      <Box marginBottom="2x">
        <Text marginBottom="1x">The minimal thumb size:</Text>
        <RadioGroup onChange={value => setMinThumbSize(Number(value))} value={minThumbSize}>
          <Stack spacing="1x" shouldWrapChildren>
            <Radio value={32}>32px (default)</Radio>
            <Radio value={16}>16px (customization)</Radio>
          </Stack>
        </RadioGroup>
      </Box>
      <Box marginBottom="2x">
        <Text marginBottom="1x">Data row:</Text>
        <RadioGroup onChange={value => setDataRow(Number(value))} value={dataRow}>
          <Stack spacing="1x" shouldWrapChildren>
            <Radio value={8}>8 rows</Radio>
            <Radio value={24}>24 rows</Radio>
          </Stack>
        </RadioGroup>
      </Box>
      <Box>
        <Text marginBottom="1x">Result:</Text>
        <Scrollbar
          height={120}
          border={1}
          borderColor="#424242"
          overflow="scroll"
          minThumbSize={minThumbSize}
        >
          <Lorem count={dataRow} px="4x" py="3x" />
        </Scrollbar>
      </Box>
    </>
  );
}
```

### The fixed thumb size

Use the `thumbSize` attribute to set a fixed size (in pixels) for thumbs.

```jsx
function FixedThumbSizeScroll() {
  const [thumbSize, setThumbSize] = React.useState(-1);
  const [dataRow, setDataRow] = React.useState(8);

  return (
    <>
      <Box marginBottom="2x">
        <Text marginBottom="1x">The fixed thumb size:</Text>
        <RadioGroup onChange={value => setThumbSize(Number(value))} value={thumbSize}>
          <Stack spacing="1x" shouldWrapChildren>
            <Radio value={-1}>undefined (default)</Radio>
            <Radio value={100}>100px (customization)</Radio>
          </Stack>
        </RadioGroup>
      </Box>
      <Box marginBottom="2x">
        <Text marginBottom="1x">Data row:</Text>
        <RadioGroup onChange={value => setDataRow(Number(value))} value={dataRow}>
          <Stack spacing="1x" shouldWrapChildren>
            <Radio value={8}>8 rows</Radio>
            <Radio value={24}>24 rows</Radio>
          </Stack>
        </RadioGroup>
      </Box>
      <Box>
        <Text marginBottom="1x">Result:</Text>
        <Scrollbar
          height={120}
          border={1}
          borderColor="#424242"
          overflow="scroll"
          thumbSize={thumbSize === -1 ? undefined : thumbSize}
        >
          <Lorem count={dataRow} px="4x" py="3x" />
        </Scrollbar>
      </Box>
    </>
  );
}
```

### Scrollable menu

```jsx
<Menu width="160px">
  <MenuButton width="100%">Select an option</MenuButton>
  <MenuList width="100%" height={200}>
    <Scrollbar>
      <MenuItem>List item 1</MenuItem>
      <MenuItem>List item 2</MenuItem>
      <MenuItem>List item 3</MenuItem>
      <MenuItem>List item 4</MenuItem>
      <MenuItem>List item 5</MenuItem>
      <MenuItem>List item 6</MenuItem>
      <MenuItem>List item 7</MenuItem>
      <MenuItem>List item 8</MenuItem>
      <MenuItem>List item 9</MenuItem>
      <MenuItem>List item 10</MenuItem>
      <MenuItem>List item 11</MenuItem>
      <MenuItem>List item 12</MenuItem>
    </Scrollbar>
  </MenuList>
</Menu>
```

### Scrollable table

```jsx noInline
const CustomScrollbar = ({
  children,
  ...rest
}) => {
  const [colorMode] = useColorMode();
  const backgroundColor = {
    dark: 'gray:70',
    light: 'gray:70',
  }[colorMode];

  return (
    <Scrollbar
      {...rest}
    >
      {({
        ScrollView,
        HorizontalTrack,
        VerticalTrack,
        HorizontalThumb,
        VerticalThumb,
        getScrollViewProps,
        getHorizontalTrackProps,
        getVerticalTrackProps,
        getHorizontalThumbProps,
        getVerticalThumbProps,
      }) => (
        <>
          <ScrollView {...getScrollViewProps()}>
            {children}
          </ScrollView>
          <HorizontalTrack
            {...getHorizontalTrackProps()}
            backgroundColor={backgroundColor}
          >
            <HorizontalThumb {...getHorizontalThumbProps()} />
          </HorizontalTrack>
          <VerticalTrack
            {...getVerticalTrackProps()}
            backgroundColor={backgroundColor}
          >
            <VerticalThumb {...getVerticalThumbProps()} />
          </VerticalTrack>
        </>
      )}
    </Scrollbar>
  );
};

function ScrollableTable() {
  const tableHeaderRef = React.createRef();
  const [state, setState] = React.useState({
    isHorizontalScrollbarVisible: false,
    isVerticalScrollbarVisible: false,
  });

  const columns = React.useMemo(() => [
    {
      Header: 'Event Type',
      accessor: 'eventType',
    },
    {
      Header: 'Affected Devices',
      accessor: 'affectedDevices',
      customProps: {
        textAlign: 'right',
      },
    },
    {
      Header: 'Detections',
      accessor: 'detections',
      customProps: {
        textAlign: 'right',
      },
    },
  ], []);

  const data = React.useMemo(() => [
    { id: 1, eventType: 'Virus/Malware', affectedDevices: 20, detections: 634 },
    { id: 2, eventType: 'Spyware/Grayware', affectedDevices: 20, detections: 634 },
    { id: 3, eventType: 'URL Filtering', affectedDevices: 15, detections: 598 },
    { id: 4, eventType: 'Web Reputation', affectedDevices: 15, detections: 598 },
    { id: 5, eventType: 'Network Virus', affectedDevices: 15, detections: 497 },
    { id: 6, eventType: 'Application Control', affectedDevices: 0, detections: 0 }
  ], []);

  const onScroll = (e) => {
    const scrollLeft = e.target.scrollLeft;
    if (tableHeaderRef.current && tableHeaderRef.current.scrollLeft !== scrollLeft) {
      tableHeaderRef.current.scrollLeft = scrollLeft;
    }
  };

  const onUpdate = (props) => {
    const { scrollWidth, clientWidth, scrollHeight, clientHeight } = props;
    const isHorizontalScrollbarVisible = (scrollWidth > clientWidth);
    const isVerticalScrollbarVisible = (scrollHeight > clientHeight);

    setState({
      isHorizontalScrollbarVisible,
      isVerticalScrollbarVisible,
    });
  };

  const {
    getTableProps,
    getTableBodyProps,
    headerGroups,
    rows,
    prepareRow
  } = useTable(
    {
      columns,
      data,
    },
    useBlockLayout,
  );
  
  return (
    <Table
      variant="outline"
      width={400}
      height={200}
      {...getTableProps()}
    >
      <TableHeader ref={tableHeaderRef}>
        {headerGroups.map(headerGroup => {
          const { style, ...props } = headerGroup.getHeaderGroupProps();
          let headerWidth = style.width;
          if (state.isVerticalScrollbarVisible) {
            headerWidth = `calc(${style.width} + 8px)`; // 8px is scrollbar width
          }
          return (
            <TableHeaderRow style={{...style, width: headerWidth}} {...props}>
              {headerGroup.headers.map((column, index) => (
                <TableHeaderCell
                  key={column.accessor}
                  {...column.getHeaderProps()}
                  {...column.customProps}
                  {...(state.isVerticalScrollbarVisible && index === headerGroup.headers.length - 1) && {
                    borderRight: 0,
                  }}
                >
                  {column.render('Header')}
                </TableHeaderCell>
              ))}
              {state.isVerticalScrollbarVisible && (
                <TableHeaderCell width="2x" padding={0} borderLeft={0} />
              )}
            </TableHeaderRow>
          );
        })}
      </TableHeader>
      <CustomScrollbar
        onScroll={onScroll}
        onUpdate={onUpdate}
      >
        <TableBody {...getTableBodyProps()}>
          {rows.map((row, index) => {
            prepareRow(row);
            return (
              <TableRow
                {...row.getRowProps()}
                key={index}
                _hover={{
                  bg: 'rgba(255, 255, 255, 0.12)'
                }}
              >
                {row.cells.map(cell => {
                  return (
                    <TableCell
                      key={cell.id}
                      {...cell.getCellProps()}
                      {...cell.column.customProps}
                    >
                      {cell.render('Cell')}
                    </TableCell>
                  );
                })}
              </TableRow>
            );
          })}
        </TableBody>
      </CustomScrollbar>
    </Table>
  );
}

render(<ScrollableTable />);
```

### Scroll indicator

The scroll indicator can visually indicate the current scroll position of the scrollable element, so that the user knows whether it can be scrolled further.

```jsx noInline
const ScrollbarWithIndicators = (props) => {
  const topIndicatorRef = React.useRef(null);
  const bottomIndicatorRef = React.useRef(null);
  const handleUpdate = ({ values }) => {
    const { scrollTop, scrollHeight, clientHeight } = values;
    const topIndicatorOpacity = 1 / 20 * Math.min(scrollTop, 20);
    const bottomScrollTop = scrollHeight - clientHeight;
    const bottomIndicatorOpacity = 1 / 20 * (bottomScrollTop - Math.max(scrollTop, bottomScrollTop - 20));
    topIndicatorRef.current.style.opacity = topIndicatorOpacity;
    bottomIndicatorRef.current.style.opacity = bottomIndicatorOpacity;
  };

  return (
    <Box position="relative">
      <Scrollbar
        onUpdate={handleUpdate}
        {...props}
      />
      <Box
        ref={topIndicatorRef}
        position="absolute"
        top="0"
        left="0"
        right="0"
        height="24px"
        background="linear-gradient(to bottom, rgba(33, 33, 33, 1) 0%, rgba(255, 255, 255, 0) 100%)"
      />
      <Box
        ref={bottomIndicatorRef}
        position="absolute"
        bottom="0"
        left="0"
        right="0"
        height="24px"
        background="linear-gradient(to top, rgba(33, 33, 33, 1) 0%, rgba(255, 255, 255, 0) 100%)"
      />
    </Box>
  );
}

render(
  <ScrollbarWithIndicators height={300}>
    <Lorem count={10} px="4x" py="3x" />
  </ScrollbarWithIndicators>
);
```

## Props

| Name | Type | Default | Description |
| :--- | :--- | :------ | :---------- |
| disabled | boolean | | If `true`, the overflow is clipped, and the rest of the content is hidden. |
| maxHeight | number \| string | 'auto' | Set a minimum height (in pixels) for auto-height mode. If `maxHeight` is not 'auto', activate auto-height mode. |
| minHeight | number \| string | 'auto' | Set a maximum height (in pixels) for auto-height mode. |
| minThumbSize | number | 32 | Minimal thumb size in pixels. |
| onScroll | function | | Callback function that is called when the scrollbar is scrolled. |
| onUpdate | function | | Callback function that is called when the scrollbar is updated. |
| overflow | string | 'auto' | Set the overflow mode. One of: 'auto', 'scroll', 'hidden'. |
| thumbSize | number | | Set a fixed size (in pixels) for thumbs. |
